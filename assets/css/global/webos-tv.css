/**
 * webOS TV Optimizations
 *
 * Refactored for TV navigation best practices.
 * Uses the .webosTV body class added dynamically when running on webOS.
 */

/* ============================================
   Hide cursor on TV
   ============================================ */

body.webosTV,
body.webosTV * {
  cursor: none !important;
}

body.webosTV input,
body.webosTV textarea,
body.webosTV select {
  cursor: text !important;
}

/* ============================================
   Sidebar Navigation for TV
   ============================================ */

body.webosTV {
  --sidebar-width: 100px !important;
  --tv-focus-outline: 4px;
  --tv-focus-color: var(--theme-color, #6313bc);

  scroll-behavior: smooth;
}

body.webosTV .desktopOnly {
  display: none !important;
}

/* Show player controls on TV */
body.webosTV .desktopOnly[class*='PlayerControls'],
body.webosTV .desktopOnly[class*='playerControls'] {
  display: flex !important;
}

body.webosTV .desktopOnly[class*='playerOptions'] {
  display: flex !important;
}

body.webosTV .desktopOnly[class*='trackSeeker'] {
  display: block !important;
}

body.webosTV .mobileOnly[class*='playPauseButton'] {
  display: none !important;
}

body.webosTV .mobileOnly[class*='queueControl'] {
  display: none !important;
}

/* Hide bookmark elements on TV */
body.webosTV [class*='bookmark'],
body.webosTV [class*='Bookmark'] {
  display: none !important;
}

body.webosTV a[title='Bookmarks'],
body.webosTV a[href*='bookmarks'] {
  display: none !important;
}

/* Track seeker - non-focusable */
body.webosTV .desktopOnly[class*='trackSeeker'],
body.webosTV .desktopOnly[class*='trackSeeker'] * {
  pointer-events: none !important;
  cursor: none !important;
  user-select: none !important;
}

body.webosTV .desktopOnly[class*='trackSeeker'] input:focus,
body.webosTV .desktopOnly[class*='trackSeeker'] input:focus-visible,
body.webosTV .desktopOnly[class*='trackSeeker'] *:focus,
body.webosTV .desktopOnly[class*='trackSeeker'] *:focus-visible {
  outline: none !important;
  box-shadow: none !important;
}

body.webosTV .mobileOnly {
  display: flex !important;
}

/* Left vertical navigation */
body.webosTV nav ul[class*='mobileNavigation'] {
  position: fixed;
  inset: 0 auto 0 0 !important;
  z-index: 9 !important;
  flex-direction: column !important;
  gap: var(--space-16) !important;
  width: 100px !important;
  height: 100vh !important;
  padding: var(--space-24) var(--space-8) !important;
  border-top: none !important;
  border-right: 1px solid var(--border-color) !important;
}

body.webosTV nav ul[class*='mobileNavigation'] li {
  flex: 0 !important;
  width: 100% !important;
}

body.webosTV nav ul[class*='mobileNavigation'] a {
  flex-direction: column !important;
  gap: var(--space-4) !important;
  align-items: center !important;
  justify-content: center !important;
  padding: var(--space-12) var(--space-4) !important;
  font-size: 0.7rem !important;
  line-height: 1.2 !important;
  text-align: center !important;
  border-radius: var(--border-radius-small) !important;
  transition: all 0.15s ease !important;
}

body.webosTV nav ul[class*='mobileNavigation'] svg {
  width: 32px !important;
  height: 32px !important;
}

body.webosTV main[class*='mainContent'] {
  margin-left: 100px !important;
}

body.webosTV header[class*='header'] {
  margin-left: 100px !important;
}

body.webosTV .mobileOnly[class*='MusicLogo'] {
  display: none !important;
}

/* ============================================
   Top Bar Modifications
   ============================================ */

body.webosTV header a[title='Home'] {
  display: none !important;
}

body.webosTV button[id='view-layout-button'],
body.webosTV button[id*='viewLayout'] {
  display: none !important;
}

body.webosTV form {
  position: relative;
}

body.webosTV .webos-search-wrapper {
  width: 0 !important;
  min-width: 0 !important;
  overflow: hidden !important;
  opacity: 0 !important;
  transition: all 0.3s ease !important;
}

body.webosTV input[id='search-input'] {
  width: 0 !important;
  min-width: 0 !important;
  padding: 0 !important;
  border: none !important;
  opacity: 0 !important;
  transition: all 0.3s ease !important;
}

body.webosTV form.searchExpanded .webos-search-wrapper {
  width: 300px !important;
  min-width: 300px !important;
  margin-right: var(--space-8) !important;
  overflow: visible !important;
  opacity: 1 !important;
}

body.webosTV form.searchExpanded input[id='search-input'] {
  width: 100% !important;
  min-width: 100% !important;
  padding: calc(var(--space-12) - 2px) var(--space-12) !important;
  border: 1px solid var(--border-color) !important;
  opacity: 1 !important;
}

body.webosTV form button[type='submit'] {
  position: relative !important;
  z-index: 2 !important;
}

/* ============================================
   Hide "See All" Links
   ============================================ */

body.webosTV a.mobileOnly.link {
  display: none !important;
}

body.webosTV h3 a {
  pointer-events: none !important;
  cursor: default !important;
}

body.webosTV h3 a svg {
  display: none !important;
}

/* ============================================
   Focus States - Clear and Visible
   ============================================ */

/* Global focus outline */
body.webosTV :focus,
body.webosTV :focus-visible {
  outline: none !important;
  box-shadow: 0 0 0 var(--tv-focus-outline) var(--tv-focus-color) !important;
  border-radius: var(--border-radius-small) !important;
}

/* Navigation items */
body.webosTV nav ul[class*='mobileNavigation'] a:focus,
body.webosTV nav ul[class*='mobileNavigation'] a:focus-visible {
  box-shadow: 0 0 0 var(--tv-focus-outline) var(--tv-focus-color) !important;
  background-color: color-mix(
    in oklab,
    var(--tv-focus-color) 25%,
    transparent
  ) !important;
  transform: scale(1.05);
}

/* Page links (Discover, Podcasts, etc.) */
body.webosTV .pageLink:focus,
body.webosTV .pageLink:focus-visible {
  box-shadow: 0 0 0 var(--tv-focus-outline) var(--tv-focus-color) !important;
  background-color: color-mix(
    in oklab,
    var(--tv-focus-color) 30%,
    transparent
  ) !important;
  transform: scale(1.05);
}

/* Album/artist/playlist images */
body.webosTV .layoutImage a:focus,
body.webosTV .layoutImage a:focus-visible {
  display: block !important;
  border-radius: var(--border-radius-large) !important;
  box-shadow: 0 0 0 var(--tv-focus-outline) var(--tv-focus-color) !important;
  transform: scale(1.03);
  transition: all 0.15s ease !important;
}

body.webosTV .layoutImage {
  padding: 4px !important;
}

body.webosTV .layoutImage a {
  display: block !important;
  pointer-events: auto !important;
}

body.webosTV .layoutImage figure {
  display: block !important;
}

/* Genre items */
body.webosTV swiper-slide[data-test-id='random-genre-item'] {
  padding: 4px !important;
}

body.webosTV swiper-slide[data-test-id='random-genre-item']:focus,
body.webosTV swiper-slide[data-test-id='random-genre-item']:focus-within {
  box-shadow: 0 0 0 var(--tv-focus-outline) var(--tv-focus-color) !important;
  border-radius: var(--border-radius-small) !important;
}

/* Buttons */
body.webosTV button:focus,
body.webosTV button:focus-visible {
  box-shadow: 0 0 0 var(--tv-focus-outline) var(--tv-focus-color) !important;
  transform: scale(1.05);
  transition: all 0.15s ease !important;
}

/* Input fields */
body.webosTV input:focus,
body.webosTV input:focus-visible,
body.webosTV textarea:focus,
body.webosTV textarea:focus-visible {
  box-shadow: 0 0 0 var(--tv-focus-outline) var(--tv-focus-color) !important;
  border-color: var(--tv-focus-color) !important;
}

/* Links */
body.webosTV a[href]:focus,
body.webosTV a[href]:focus-visible {
  box-shadow: 0 0 0 var(--tv-focus-outline) var(--tv-focus-color) !important;
}

/* Track row focus override - don't add outline to links inside */
body.webosTV .trackRow a:focus,
body.webosTV .trackRow a:focus-visible {
  box-shadow: none !important;
}

/* Playlist cards */
body.webosTV article[data-test-id='playlist'] a:focus,
body.webosTV article[data-test-id='playlist'] a:focus-visible {
  box-shadow: 0 0 0 var(--tv-focus-outline) var(--tv-focus-color) !important;
  transform: scale(1.02);
  transition: all 0.15s ease !important;
}

/* ============================================
   Hide Hover Effects
   ============================================ */

body.webosTV [class*='actions'] {
  display: none !important;
}

body.webosTV article[data-test-id='playlist'] [class*='dropdown'] {
  display: none !important;
}

body.webosTV [class*='carouselSwiper'] button[class*='previous'],
body.webosTV [class*='carouselSwiper'] button[class*='next'] {
  display: none !important;
}

/* ============================================
   Simplified Navigation on List Pages
   ============================================ */

body.webosTV .layoutContent a,
body.webosTV .layoutContent button {
  pointer-events: none;
}

body.webosTV .layoutContent a:focus,
body.webosTV .layoutContent button:focus {
  outline: none !important;
  box-shadow: none !important;
}

/* ============================================
   Track Row Focus
   ============================================ */

body.webosTV .trackRow:focus-within {
  position: relative;
  z-index: 1;
  background-color: color-mix(
    in oklab,
    var(--tv-focus-color) 20%,
    transparent
  ) !important;
  border-radius: var(--border-radius-small) !important;
}

body.webosTV .trackRow button:focus,
body.webosTV .trackRow button:focus-visible {
  outline: none !important;
  background-color: transparent !important;
  box-shadow: none !important;
}

body.webosTV .trackRow .mobileOnly {
  display: none !important;
}

body.webosTV .trackRow {
  position: relative;
}

body.webosTV .trackRow [class*='playPauseWrapper'] {
  position: absolute !important;
  inset: 0 !important;
  z-index: 1;
  visibility: visible !important;
  width: 100% !important;
  height: 100% !important;
  opacity: 0 !important;
  transform: unset !important;
}

body.webosTV .trackRow [class*='playPauseWrapper'] button {
  width: 100% !important;
  height: 100% !important;
  border-radius: 0 !important;
}

/* ============================================
   Login Page
   ============================================ */

body.webosTV .loginForm input:focus,
body.webosTV .loginForm input:focus-visible {
  box-shadow: 0 0 0 var(--tv-focus-outline) var(--tv-focus-color) !important;
}

body.webosTV .loginForm button:focus,
body.webosTV .loginForm button:focus-visible {
  box-shadow: 0 0 0 var(--tv-focus-outline) var(--tv-focus-color) !important;
  transform: scale(1.02);
}
